var VueLetItSnow=function(e){"use strict";!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),a=".snow-wrap[data-v-8db57eba] { position: fixed; left: 0; top: 0; z-index: 9999; pointer-events: none; height: 100%; width: 100%; } .snow-wrap.events-all[data-v-8db57eba] { pointer-events: all; } .snow-wrap.hide[data-v-8db57eba] { opacity: 0; -webkit-transition: opacity 1s; transition: opacity 1s; } .snow-wrap canvans[data-v-8db57eba] { display: block; height: 100%; width: 100%; } ";t.type="text/css",t.styleSheet?t.styleSheet.cssText=a:t.appendChild(document.createTextNode(a)),e.appendChild(t)}}();var t={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.myShow?a("div",{ref:"wrap",staticClass:"snow-wrap",class:{"events-all":e.interaction,hide:e.toHide}},[e._l(e.images,function(e,t){return a("img",{key:t,staticClass:"lis_flake",staticStyle:{display:"none"},attrs:{src:e}})}),e._v(" "),a("canvas",{ref:"canvas",attrs:{width:"100%",height:"100%"}})],2):e._e()},staticRenderFns:[],_scopeId:"data-v-8db57eba",name:"let-it-snow",data:function(){return{flakes:[],canvas:null,ctx:null,flakeCount:this.count,mX:-100,mY:-100,imageItems:[],imageNum:[],myShow:!1,toHide:!1,reqId:null}},props:{speed:{type:Number,default:0},interaction:{type:Boolean,default:!1},size:{type:Number,default:2},count:{type:Number,default:200},opacity:{type:Number,default:0},color:{type:String,default:"#ffffff"},windPower:{type:Number,default:0},images:{type:Array,default:function(){return[]}},show:{type:Boolean,default:!1}},watch:{show:function(e,t){var a=this;console.log(e,t),e?(this.myShow=!0,this.toHide=!1,this.$nextTick(function(){a.init()})):(this.toHide=!0,setTimeout(function(){a.myShow=!1},1100))}},mounted:function(){var e=this,t=window.requestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)};window.requestAnimationFrame=t;var a=window.cancelAnimationFrame||function(e){window.clearTimeout(e)};window.cancelAnimationFrame=a,window.onresize=function(){e.resizeTO&&clearTimeout(e.resizeTO),e.resizeTO=setTimeout(function(){e.init()},200)}},methods:{IsImageOk:function(e){return!!e.complete&&(void 0===e.naturalWidth||0!==e.naturalWidth)},snow:function(){var e=this;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=0;t<this.flakeCount;t++){var a=e.flakes[t],n=e.mX,i=e.mY,s=a.x,o=a.y,r=Math.sqrt((s-n)*(s-n)+(o-i)*(o-i));if(r<100){var h=(n-s)/r,d=(i-o)/r,l=100/(r*r)/2;a.velX-=l*h,a.velY-=l*d}else switch(a.velX*=.98,a.velY<=a.speed&&(a.velY=a.speed),e.windPower){case!1:case 0:a.velX+=Math.cos(a.step+=.05)*a.stepSize;break;default:a.velX+=.01+e.windPower/100}var c=e.color,m=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/.exec(c),u=parseInt(m[1],16)+","+parseInt(m[2],16)+","+parseInt(m[3],16);if(a.y+=a.velY,a.x+=a.velX,(a.y>=e.canvas.height||a.y<=0)&&e.reset(a),(a.x>=e.canvas.width||a.x<=0)&&e.reset(a),0==e.images.length)e.ctx.fillStyle="rgba("+u+","+a.opacity+")",e.ctx.beginPath(),e.ctx.arc(a.x,a.y,a.size,0,2*Math.PI),e.ctx.fill();else{var f=e.imageItems[t%e.imageNum];e.IsImageOk(f)&&e.ctx.drawImage(f,a.x,a.y,2*a.size,2*a.size)}}this.reqId=requestAnimationFrame(this.snow)},reset:function(e){if(0==this.windPower||0==this.windPower)e.x=Math.floor(Math.random()*this.canvas.width),e.y=0;else if(this.windPower>0){var t=Array(Math.floor(Math.random()*this.canvas.width),0),a=Array(0,Math.floor(Math.random()*this.canvas.height)),n=(i=Array(t,a))[Math.floor(Math.random()*i.length)];e.x=n[0],e.y=n[1]}else{var t=Array(Math.floor(Math.random()*this.canvas.width),0),a=Array(this.canvas.width,Math.floor(Math.random()*this.canvas.height)),i=Array(t,a),n=i[Math.floor(Math.random()*i.length)];e.x=n[0],e.y=n[1]}e.size=3*Math.random()+this.size,e.speed=1*Math.random()+this.speed,e.velY=e.speed,e.velX=0,e.opacity=.5*Math.random()+this.opacity},init:function(){var e=this;if(this.reqId&&cancelAnimationFrame(this.reqId),this.canvas=this.$refs.canvas,this.ctx=this.canvas.getContext("2d"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,1==this.interaction){var t="ontouchstart"in document.documentElement?"touchmove":"mousemove";this.canvas.addEventListener(t,function(a){"touchmove"==t?(e.mX=a.touches[0].clientX,e.mY=a.touches[0].clientY):(e.mX=a.clientX,e.mY=a.clientY)})}for(var a=0;a<this.flakeCount;a++){var n=Math.floor(Math.random()*e.canvas.width),i=Math.floor(Math.random()*e.canvas.height),s=3*Math.random()+e.size,o=1*Math.random()+e.speed,r=.5*Math.random()+e.opacity;e.flakes.push({speed:o,velY:o,velX:0,x:n,y:i,size:s,stepSize:Math.random()/30,step:0,angle:180,opacity:r})}var h=document.querySelectorAll(".lis_flake");for(a=0;a<h.length;a++)e.imageItems.push(h[a]);this.imageNum=h.length,this.snow()}}};t.install=function(e){t.installed||(t.installed=!0,e.component(t.name,t))};var a=null;return"undefined"!=typeof window?a=window.Vue:"undefined"!=typeof global&&(a=global.Vue),a&&a.use(t),e.default=t,e}({});
