{"remainingRequest":"/home/clement/APIetienne/BODIERCOIN/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/clement/APIetienne/BODIERCOIN/src/components/UpdateAccount.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/clement/APIetienne/BODIERCOIN/src/components/UpdateAccount.vue","mtime":1607807645731},{"path":"/home/clement/APIetienne/BODIERCOIN/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/clement/APIetienne/BODIERCOIN/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/clement/APIetienne/BODIERCOIN/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/clement/APIetienne/BODIERCOIN/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgppbXBvcnQgVnVlIGZyb20gJ3Z1ZScKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJwovL2ltcG9ydCBWdWVBeGlvcyBmcm9tICd2dWUtYXhpb3MnCgppbXBvcnQge21hcEdldHRlcnN9IGZyb20gJ3Z1ZXgnOwoKVnVlLnVzZSggYXhpb3MpCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlVzZXJQcm9maWxlIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcHJvZmlsZTogJycKICAgIH0KICB9LAoKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyh7CiAgICAgIGF1dGhlbnRpY2F0ZWQ6ICdhdXRoL2F1dGhlbnRpY2F0ZWQnLAogICAgICB1c2VyOiAnYXV0aC91c2VyJwogICAgfSksCgogIH0sCgogIG1ldGhvZHM6IHsKCiAgICBnZXRQcm9maWxlKCkgewogICAgICBheGlvcy5nZXQoJ2h0dHBzOi8vaGF1dGUtbG9pcmUub3JnL2FwaS91c2VyLycgKyB0aGlzLnVzZXIuaWQpCiAgICAgICAgICAudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7CiAgICAgICAgICAgIHRoaXMucHJvZmlsZSA9IHJlc3VsdC5kYXRhOwogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnByb2ZpbGUpCiAgICAgICAgICB9KQogICAgfSwKCiAgICBhc3luYyB1cGRhdGVQcm9maWxlKCkgewogICAgICBsZXQgbGF0TG9uZyA9IGF3YWl0IHRoaXMuZ2V0TGF0TG9uZygpOyAvL29uIHLDqWN1cMOocmUgbGEgbGF0IGV0IGxvbmcgZGFucyBjZXR0ZSB2YXJpYWJsZQoKICAgICAgYXhpb3MucGF0Y2goKCdodHRwczovL2hhdXRlLWxvaXJlLm9yZy9hcGkvdXNlci8nICsgdGhpcy51c2VyLmlkKSwgewogICAgICAgICdlbWFpbCc6IHRoaXMucHJvZmlsZS5lbWFpbCwKICAgICAgICAnZmlyc3ROYW1lJzogdGhpcy5wcm9maWxlLmZpcnN0TmFtZSwKICAgICAgICAnbGFzdE5hbWUnOiB0aGlzLnByb2ZpbGUubGFzdE5hbWUsCiAgICAgICAgJ2FkZHJlc3MnOiB0aGlzLnByb2ZpbGUuYWRkcmVzcywKICAgICAgICAnY2l0eSc6IHRoaXMucHJvZmlsZS5jaXR5LAogICAgICAgICdwb3N0YWxDb2RlJzogdGhpcy5wcm9maWxlLnBvc3RhbENvZGUsCiAgICAgICAgJ25hbWUnOiB0aGlzLnByb2ZpbGUuZmlyc3ROYW1lKyIgIit0aGlzLnByb2ZpbGUubGFzdE5hbWUsCiAgICAgICAgJ2xhdGl0dWRlJzogbGF0TG9uZ1swXSwgLy9sYXRpdHVkZSBlc3QgbGUgcHJlbWllciDDqWzDqW1lbnQgZGUgbGEgdmFyaWFibGUgbGF0TG9uZwogICAgICAgICdsb25naXR1ZGUnOiBsYXRMb25nWzFdICAvL2xvbmdpdHVkZSBlc3QgbGUgc2Vjb25kIMOpbMOpbWVudCBkZSBsYSB2YXJpYWJsZSBsYXRMb25nCiAgICAgICAgICAgICAgICAgICAgCiAgICAgIH0pCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgICAgfSk7CiAgICAgICAgICAvL2FsZXJ0KCJMYSBtaXNlIMOgIGpvdXIgYSDDqXTDqSBlZmZlY3R1w6llIGF2ZWMgc3VjY8OocyIpOwogICAgfSwKICAgIGFzeW5jIGdldExhdExvbmcoKSB7IAogICAgICAgICAgICBsZXQgdXJsID0gImh0dHBzOi8vbm9taW5hdGltLm9wZW5zdHJlZXRtYXAub3JnL3NlYXJjaC5waHAiOwogICAgICAgICAgICBsZXQgcGFyYW1zID0gewogICAgICAgICAgICAgICAgcTogdGhpcy5hZHJlc3MrIiAiK3RoaXMuY2l0eSsiICIrdGhpcy5wb3N0Q29kZSwKICAgICAgICAgICAgICAgIGZvcm1hdDogJ2pzb24nLAogICAgICAgICAgICAgICAgYWRkcmVzc2RldGFpbHM6IDEKICAgICAgICAgICAgfTsKICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgYXhpb3MuZ2V0KHVybCwge3BhcmFtczogcGFyYW1zfSk7IC8vb24gc3RvY2sgbGEgcsOpcG9uc2UgZGFucyBjZXR0ZSB2YXJpYWJsZQogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YVswXS5sYXQpOwogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YVswXS5sb24pOwogICAgICAgICAgICByZXR1cm4gW3Jlcy5kYXRhWzBdLmxhdCwgcmVzLmRhdGFbMF0ubG9uXTsgLy9vbiByZXRvdXJuZSB1biB0YWJsZWF1IGF2ZWMgbGVzIDIgw6lsw6ltZW50cwoKICAgICAgICB9CiAgfSwKCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0UHJvZmlsZSgpOwogICAgdGhpcy51cGRhdGVQcm9maWxlKCkKICB9Cn0KCg=="},{"version":3,"sources":["UpdateAccount.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"UpdateAccount.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <br>\n    <h3>Vos informations personnelles :</h3>\n    <br><br>\n\n    <form class=\"form\" @submit.prevent=\"updateProfile\">\n      <label>\n        <textarea class=\"border rounded p-3\" v-model=\"profile.firstName\"></textarea>\n      </label>\n      <tag class=\"border rounded p-3\">Prénom</tag>\n      <p></p>\n      <label>\n        <textarea class=\"border rounded p-3\" v-model=\"profile.lastName\"></textarea>\n      </label>\n      <tag class=\"border rounded p-3\">Nom</tag>\n      <p></p>\n      <label>\n        <textarea class=\"border rounded p-3\" v-model=\"profile.email\"></textarea>\n      </label>\n      <tag class=\"border rounded p-3\">Mail</tag>\n      <p></p>\n      <label>\n        <textarea class=\"border rounded p-3\" v-model=\"profile.address\"></textarea>\n      </label>\n      <tag class=\"border rounded p-3\">Adresse</tag>\n      <p></p>\n      <label>\n        <textarea class=\"border rounded p-3\" v-model=\"profile.city\"></textarea>\n      </label>\n      <tag class=\"border rounded p-3\">Ville</tag>\n      <p></p>\n      <label>\n        <textarea class=\"border rounded p-3\" v-model=\"profile.postalCode\"></textarea>\n      </label>\n      <tag class=\"border rounded p-3\">Code postal</tag>\n      <p></p>\n      <button type=\"submit\" class=\"border btn btn-lg btn-dark rounded p-3\">Editer le profil</button>\n    </form>\n    <br>\n    <br>\n  </div>\n</template>\n\n<script>\n\nimport Vue from 'vue'\nimport axios from 'axios'\n//import VueAxios from 'vue-axios'\n\nimport {mapGetters} from 'vuex';\n\nVue.use( axios)\n\nexport default {\n  name: \"UserProfile\",\n  data() {\n    return {\n      profile: ''\n    }\n  },\n\n  computed: {\n    ...mapGetters({\n      authenticated: 'auth/authenticated',\n      user: 'auth/user'\n    }),\n\n  },\n\n  methods: {\n\n    getProfile() {\n      axios.get('https://haute-loire.org/api/user/' + this.user.id)\n          .then((result) => {\n            console.log(result);\n            this.profile = result.data;\n            console.log(this.profile)\n          })\n    },\n\n    async updateProfile() {\n      let latLong = await this.getLatLong(); //on récupère la lat et long dans cette variable\n\n      axios.patch(('https://haute-loire.org/api/user/' + this.user.id), {\n        'email': this.profile.email,\n        'firstName': this.profile.firstName,\n        'lastName': this.profile.lastName,\n        'address': this.profile.address,\n        'city': this.profile.city,\n        'postalCode': this.profile.postalCode,\n        'name': this.profile.firstName+\" \"+this.profile.lastName,\n        'latitude': latLong[0], //latitude est le premier élément de la variable latLong\n        'longitude': latLong[1]  //longitude est le second élément de la variable latLong\n                    \n      })\n          .then((response) => {\n            console.log(response);\n          });\n          //alert(\"La mise à jour a été effectuée avec succès\");\n    },\n    async getLatLong() { \n            let url = \"https://nominatim.openstreetmap.org/search.php\";\n            let params = {\n                q: this.adress+\" \"+this.city+\" \"+this.postCode,\n                format: 'json',\n                addressdetails: 1\n            };\n            const res = await axios.get(url, {params: params}); //on stock la réponse dans cette variable\n            console.log(res.data[0].lat);\n            console.log(res.data[0].lon);\n            return [res.data[0].lat, res.data[0].lon]; //on retourne un tableau avec les 2 éléments\n\n        }\n  },\n\n  mounted() {\n    this.getProfile();\n    this.updateProfile()\n  }\n}\n\n</script>\n\n<style scoped>\n\n</style>"]}]}